

A deep-learning powered API that answers natural-language questions about members using only data from the public **`/messages`** API.

---

## ðŸ“Œ Overview

This service allows clients to ask questions such as:

| Example Question                               | Expected Type      |
| ---------------------------------------------- | ------------------ |
| *â€œWhen is Layla planning her trip to London?â€* | Date / Schedule    |
| *â€œHow many cars does Vikram Desai have?â€*      | Number / Count     |
| *â€œWhat are Amiraâ€™s favorite restaurants?â€*     | Preferences / List |

The system receives a free-form question, searches member messages, extracts relevant information, and responds:

```json
{ "answer": "..." }
```

The system is implemented with **FastAPI** and **local deep-learning models**â€”no external LLM APIs are used.

---

## âš™ï¸ How It Works

The QA engine follows a **retrieval-augmented deep learning pipeline**:

1. Fetch all messages from the public `/messages` API
2. Store them locally in `messages.json`
3. Convert every message into a dense embedding using:

   ```
   sentence-transformers/all-MiniLM-L6-v2
   ```
4. For every question:

   * Detect **which member the question is about**
   * Restrict search to **messages from that member only**
   * Use cosine similarity to retrieve top-k relevant messages
   * Run a **QA model**:

     ```
     deepset/roberta-base-squad2
     ```

     to extract an exact answer
5. If extraction fails, return a **fallback answer** using the most relevant message from *that member only*.

### â— Key Guarantee

> The system never mixes members.
> If the question is about *Amira*, results will **only** come from *Amiraâ€™s messages* â€” never from Layla or anyone else.

---

## ðŸ”¥ Features

| Feature                         | Status |
| ------------------------------- | ------ |
| Natural-language question input | âœ…      |
| Deep-learning semantic search   | âœ…      |
| Extractive answer generation    | âœ…      |
| Member-restricted search        | âœ…      |
| Best-effort fallback            | âœ…      |
| `/refresh` to reload dataset    | âœ…      |
| Web UI (`index.html`)           | âœ…      |

---

## ðŸ§  Tech Stack

| Component                | Purpose                     |
| ------------------------ | --------------------------- |
| FastAPI                  | REST API                    |
| Sentence-Transformers    | Message semantic embeddings |
| HuggingFace Transformers | Extractive QA               |
| Torch                    | Model inference             |
| NumPy                    | Vector similarity           |
| Vanilla JS + HTML        | Test UI                     |

---

## ðŸ”Œ API Endpoints

| Method | Route               | Description                            |
| ------ | ------------------- | -------------------------------------- |
| `GET`  | `/ask?question=...` | Ask any natural-language question      |
| `GET`  | `/refresh`          | Re-download messages and rebuild index |
| `GET`  | `/`                 | Web UI for testing                     |

### Example Request

```
GET /ask?question=When%20is%20Layla%20planning%20her%20trip%20to%20London%3F
```

### Example Response

```json
{ "answer": "Layla has a chauffeur scheduled to pick her up in London on March 19, 2025 at 9:30 AM." }
```

---

## â–¶ï¸ Running Locally

### Install dependencies

```
pip install -r requirements.txt
```

### Start server

```
uvicorn main:app --host 0.0.0.0 --port 8080
```

### Open UI

```
http://localhost:8080
```

---

## ðŸ§ª Example Questions to Try

| Question                                         | Expected Outcome                                                             |
| ------------------------------------------------ | ---------------------------------------------------------------------------- |
| â€œWhat is Laylaâ€™s seating preference on flights?â€ | Extracts â€œaisle seatsâ€                                                       |
| â€œWhen is Amira traveling to Tokyo?â€              | Date if available, otherwise fallback                                        |
| â€œHow many cars does Vikram Desai own?â€           | Explicit number or a fallback explanation                                    |
| â€œBook me a restaurantâ€                           | Will identify the relevant member and return the closest reservation message |

---

## ðŸ“˜ Bonus 1 â€” Design Notes (Alternative Approaches Considered)

Several options were evaluated before selecting the current architecture.

### A. Keyword Search

Too brittle â€” fails when questions are paraphrased.

### B. TF-IDF + Cosine Similarity

Better recall but still confuses members with overlapping vocabulary.

### C. End-to-End LLM

Best language understanding but requires external APIs / GPU hosting, not permitted in this challenge context.

### âœ” Final Choice â€” Hybrid Retrieval + Extractive QA

Combines:

* Sentence-Transformer embeddings â†’ semantic retrieval
* Extractive QA model â†’ precise answer spans
* Member filtering â†’ prevents cross-member contamination
* Fallback logic â†’ never leaves the user without a response

---

## ðŸ“˜ Bonus 2 â€” Data Insights (Anomalies Observed)

During dataset exploration, the following inconsistencies were noted:

| Category      | Finding                                                   | Impact                                   |
| ------------- | --------------------------------------------------------- | ---------------------------------------- |
| Identity      | Some members appear with slightly different names         | Risk of splitting data across identities |
| Content       | Some entries are metadata without message text            | Must be filtered out                     |
| Time          | Many events are scheduled far into the future (2025â€“2026) | Suggests synthetic / simulated dataset   |
| Semantics     | Some facts are implied but not explicit                   | Requires safe fallback behavior          |
| Topic overlap | Many members talk about travel/restaurants                | Can confuse naive similarity models      |

These insights influenced the final model:

* Strict **member filtering**
* Fallback answers that **never hallucinate**
* Only extracting facts that are explicitly stated

---

## ðŸ“„ Folder Structure (Recommended)

```
project/
â”‚ main.py
â”‚ requirements.txt
â”‚ README.md
â”‚ messages.json  (autogenerated)
â”‚ index.html
â””â”€ models/       (optional cache if pre-downloaded)
```

---

## ðŸš€ Deployment Notes

The API is compatible with:

| Environment      | Works? |
| ---------------- | ------ |
| Local / laptop   | âœ…      |
| Docker container | âœ…      |
| Render / Railway | âœ…      |
| Google Cloud Run | âœ…      |

The models are downloaded only **once**, then cached for future runs.

---

## ðŸ“« Contact & Support

If you'd like help deploying to a cloud provider or adding:

* async batching
* vector database storage
* conversation memory
* evaluation metrics
* logging and observability

just create a GitHub issue or reach out.

---

### ðŸŽ¯ Final Statement

> This project demonstrates that high-quality natural-language question answering can be achieved from structured user messages without external LLM APIs â€” by combining deep learning semantic retrieval, extractive QA, and carefully engineered fallback strategies.

---
